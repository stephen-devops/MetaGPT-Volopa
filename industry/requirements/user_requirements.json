{
  "project_metadata": {
    "project_name": "Volopa Mass Payments API",
    "version": "2.0.0",
    "created_date": "2025-12-04",
    "last_modified": "2026-01-12",
    "description": "Laravel API system for uploading CSV files with up to 10,000 payment instructions",
    "source_documents": [
      "Mass Payments PPTX",
      "natural_language_requirements_v4.md",
      "requirements_classification_v4.md"
    ],
    "framework": "Laravel 10+",
    "php_version": "8.2+",
    "api_prefix": "/api/v1",
    "max_file_capacity": 10000,
    "total_requirements": 76,
    "environment_specific_requirements": 29,
    "project_specific_requirements": 47
  },

  "agent_assignments": {
    "LaravelProductManager": {
      "consumes": ["all_functional_requirements"],
      "output": "docs/prd/volopa_mass_payments.md",
      "responsibilities": [
        "Transform ALL 76 functional requirements into Product Requirements Document (PRD)",
        "Define business requirements, user stories, acceptance criteria",
        "Specify API endpoints and validation rules at business level",
        "Prioritize requirements (P0, P1, P2)",
        "Include Detailed Functional Requirements section with all requirements",
        "Include Requirements Classification Summary (environment-specific vs project-specific)"
      ],
      "constraints_source": "business_level_laravel_awareness"
    },
    "LaravelArchitect": {
      "consumes": ["all_functional_requirements", "prd", "dos_donts_architectural"],
      "output": "docs/system_design/volopa_mass_payments.md",
      "responsibilities": [
        "Design system architecture, data models, API structure",
        "Design database schema with relationships",
        "Design service layer and validation architecture",
        "Specify transaction boundaries, N+1 prevention, pagination, caching",
        "Design environment-specific requirements as configurable",
        "Design project-specific requirements as reusable core logic"
      ],
      "constraints_source": "dos_and_donts.pdf (architectural patterns)"
    },
    "LaravelProjectManager": {
      "consumes": ["all_functional_requirements", "prd", "system_design"],
      "output": "docs/task/volopa_mass_payments.json",
      "responsibilities": [
        "Create task breakdown for implementation",
        "Map 76 requirements to implementation tasks",
        "Define task dependencies and execution order"
      ],
      "constraints_source": "task_breakdown_methodology"
    },
    "LaravelEngineer": {
      "consumes": ["all_tasks", "system_design", "prd", "dos_donts_full"],
      "output": "app/ directory (~40 Laravel files)",
      "responsibilities": [
        "Implement all tasks from ProjectManager",
        "Write Laravel code following DOS/DONTS patterns",
        "Generate controllers, models, services, migrations, tests",
        "Store environment-specific logic as config or database",
        "Implement project-specific logic as reusable services"
      ],
      "constraints_source": "dos_and_donts.pdf (full)"
    },
    "LaravelQaEngineer": {
      "consumes": ["all_requirements", "system_design", "prd", "source_code"],
      "output": "tests/ directory",
      "responsibilities": [
        "Write tests covering ALL 76 requirements",
        "Test environment-specific business rules and configuration",
        "Test project-specific generic behavior and edge cases",
        "Reference requirement IDs in test method names"
      ],
      "constraints_source": "testing_best_practices"
    }
  },

  "functional_requirements": {
    "Section_1_File_Template_Management": {
      "section_name": "File Template Management",
      "description": "Requirements for downloading, structuring, and providing guidance for CSV payment templates",
      "total_requirements": 11,
      "requirements": {
        "REQ-001": {
          "requirement": "The system shall allow business users to initiate bulk payment processing through the Volopa platform using a file upload journey.",
          "classification": "environment-specific",
          "classification_rationale": "References specific Volopa platform",
          "priority": "P0",
          "acceptance_criteria": [
            "Users can access mass payments feature from Volopa platform",
            "File upload journey is initiated through designated navigation path"
          ]
        },
        "REQ-002": {
          "requirement": "The system shall provide users with the ability to download a CSV template for mass payments from the Payments section of the platform.",
          "classification": "environment-specific",
          "classification_rationale": "References Volopa's platform navigation structure",
          "priority": "P0",
          "acceptance_criteria": [
            "Download link available in Payments section",
            "CSV template is generated and downloadable"
          ]
        },
        "REQ-003": {
          "requirement": "The system shall allow users to download recipient lists filtered by a single currency at a time.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa-specific currency handling rule",
          "priority": "P0",
          "acceptance_criteria": [
            "Currency filter available on template download",
            "Only recipients matching selected currency are included"
          ]
        },
        "REQ-004": {
          "requirement": "The system shall include up-to-date recipient information in downloaded templates to minimize manual data entry.",
          "classification": "project-specific",
          "classification_rationale": "Standard usability practice",
          "priority": "P1",
          "acceptance_criteria": [
            "Template pre-populated with current recipient data",
            "Data is synchronized from database at download time"
          ]
        },
        "REQ-005": {
          "requirement": "The system shall include the following recipient information fields in downloaded templates: Recipient ID, Client Recipient ID, Recipient Name, Recipient Bank Country, Recipient Account Currency, Available Settlement Methods, Recipient Email Address, and CC Email Address.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's specific recipient data structure",
          "priority": "P0",
          "acceptance_criteria": [
            "All 8 recipient fields are present in template",
            "Fields are properly labeled and ordered"
          ]
        },
        "REQ-006": {
          "requirement": "The system shall include the following payment fields in the template for user completion: Payment Amount, Settlement Method, Payment Reason, Payments Reference, Purpose of Payment Code, Invoice Number, Invoice Date, and Incorporation Number.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's payment data model",
          "priority": "P0",
          "acceptance_criteria": [
            "All 8 payment fields are present in template",
            "Fields are clearly marked for user input"
          ]
        },
        "REQ-007": {
          "requirement": "The system shall indicate which fields require dropdown selection versus free-text entry in the template guidance.",
          "classification": "project-specific",
          "classification_rationale": "Standard form design principle",
          "priority": "P1",
          "acceptance_criteria": [
            "Field types are documented in template guidance",
            "Dropdown fields show available values"
          ]
        },
        "REQ-008": {
          "requirement": "The system shall pre-populate Available Settlement Methods for each recipient (values: Priority, Regular, or Priority and Regular).",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's settlement method business logic",
          "priority": "P0",
          "acceptance_criteria": [
            "Settlement methods pre-populated from recipient configuration",
            "Values match: Priority, Regular, or Priority and Regular"
          ]
        },
        "REQ-009": {
          "requirement": "The system shall provide users with comprehensive guidance or instructions explaining how to complete the payment file template correctly.",
          "classification": "project-specific",
          "classification_rationale": "Standard help system",
          "priority": "P1",
          "acceptance_criteria": [
            "User guide available and accessible",
            "Guide covers all template fields"
          ]
        },
        "REQ-010": {
          "requirement": "The system shall provide contextual help or tooltips explaining field requirements and validation rules.",
          "classification": "project-specific",
          "classification_rationale": "Standard inline help pattern",
          "priority": "P2",
          "acceptance_criteria": [
            "Tooltips or help text available for each field",
            "Validation rules explained clearly"
          ]
        },
        "REQ-011": {
          "requirement": "The system shall clearly indicate when specific fields are mandatory based on payment currency or recipient type.",
          "classification": "project-specific",
          "classification_rationale": "Standard form validation UX",
          "priority": "P1",
          "acceptance_criteria": [
            "Mandatory fields marked with indicator",
            "Currency/type-specific requirements documented"
          ]
        }
      }
    },

    "Section_2_Data_Entry_Conditional_Requirements": {
      "section_name": "Data Entry and Conditional Requirements",
      "description": "Requirements for payment data entry and currency-specific mandatory fields",
      "total_requirements": 8,
      "requirements": {
        "REQ-012": {
          "requirement": "The system shall allow users to enter payment details such as amounts, settlement methods, references, and reasons directly into the CSV template.",
          "classification": "project-specific",
          "classification_rationale": "Standard data entry capability",
          "priority": "P0",
          "acceptance_criteria": [
            "All payment fields are editable in CSV",
            "Data formats are clearly specified"
          ]
        },
        "REQ-013": {
          "requirement": "The system shall allow users to specify settlement method by selecting from dropdown options: Priority or Regular.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's two-tier settlement model",
          "priority": "P0",
          "acceptance_criteria": [
            "Settlement method accepts Priority or Regular",
            "Invalid values are rejected during validation"
          ]
        },
        "REQ-014": {
          "requirement": "The system shall allow users to specify Purpose of Payment Code from a dropdown list dependent on recipient Bank Country and Account Currency.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's compliance with international payment codes",
          "priority": "P0",
          "acceptance_criteria": [
            "Purpose codes filtered by country and currency",
            "Invalid codes rejected during validation"
          ]
        },
        "REQ-015": {
          "requirement": "The system shall require Invoice Number when the recipient account currency is INR (Indian Rupee).",
          "classification": "environment-specific",
          "classification_rationale": "India-specific regulatory requirement",
          "priority": "P0",
          "acceptance_criteria": [
            "Invoice Number mandatory for INR payments",
            "Validation fails if INR payment missing Invoice Number"
          ]
        },
        "REQ-016": {
          "requirement": "The system shall require Invoice Date when the recipient account currency is INR (Indian Rupee).",
          "classification": "environment-specific",
          "classification_rationale": "India-specific regulatory requirement",
          "priority": "P0",
          "acceptance_criteria": [
            "Invoice Date mandatory for INR payments",
            "Validation fails if INR payment missing Invoice Date"
          ]
        },
        "REQ-017": {
          "requirement": "The system shall require Incorporation Number for business recipients when the account currency is TRY (Turkish Lira).",
          "classification": "environment-specific",
          "classification_rationale": "Turkey-specific regulatory requirement",
          "priority": "P0",
          "acceptance_criteria": [
            "Incorporation Number mandatory for TRY business recipients",
            "Validation fails if requirement not met"
          ]
        },
        "REQ-018": {
          "requirement": "The system shall allow users to include recipient email addresses for payment notifications.",
          "classification": "project-specific",
          "classification_rationale": "Standard notification field",
          "priority": "P1",
          "acceptance_criteria": [
            "Recipient email field available",
            "Email format validated"
          ]
        },
        "REQ-019": {
          "requirement": "The system shall allow users to include CC email addresses for additional payment notification recipients.",
          "classification": "project-specific",
          "classification_rationale": "Standard CC field pattern",
          "priority": "P2",
          "acceptance_criteria": [
            "CC email field available",
            "Multiple CC addresses supported"
          ]
        }
      }
    },

    "Section_3_File_Upload_Size_Constraints": {
      "section_name": "File Upload and Size Constraints",
      "description": "Requirements for file upload interface and capacity limits",
      "total_requirements": 6,
      "requirements": {
        "REQ-020": {
          "requirement": "The system shall allow users to upload completed payment files using a drag-and-drop area or file selection option.",
          "classification": "project-specific",
          "classification_rationale": "Standard upload UX pattern",
          "priority": "P0",
          "acceptance_criteria": [
            "Drag-and-drop upload supported",
            "File browser selection supported"
          ]
        },
        "REQ-021": {
          "requirement": "The system shall display clear visual feedback during the file upload process.",
          "classification": "project-specific",
          "classification_rationale": "Standard UX feedback pattern",
          "priority": "P1",
          "acceptance_criteria": [
            "Progress indicator shown during upload",
            "Status messages displayed"
          ]
        },
        "REQ-022": {
          "requirement": "The system shall support up to 10,000 payment instructions within a single uploaded file.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's defined business limit",
          "priority": "P0",
          "acceptance_criteria": [
            "Files with up to 10,000 rows accepted",
            "System processes all valid rows"
          ]
        },
        "REQ-023": {
          "requirement": "The system shall restrict each uploaded payment file to contain payments in one currency only.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa business rule for processing efficiency",
          "priority": "P0",
          "acceptance_criteria": [
            "Single currency validation enforced",
            "Multi-currency files rejected"
          ]
        },
        "REQ-024": {
          "requirement": "The system shall reject files exceeding the maximum payment limit of 10,000 rows.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's processing capacity constraint",
          "priority": "P0",
          "acceptance_criteria": [
            "Files with >10,000 rows rejected",
            "Clear error message provided"
          ]
        },
        "REQ-025": {
          "requirement": "The system shall prevent duplicate uploads of the same payment file.",
          "classification": "project-specific",
          "classification_rationale": "Standard data integrity control",
          "priority": "P1",
          "acceptance_criteria": [
            "Duplicate detection implemented",
            "User notified if duplicate detected"
          ]
        }
      }
    },

    "Section_4_File_Validation_Error_Handling": {
      "section_name": "File Validation and Error Handling",
      "description": "Requirements for comprehensive file and data validation with error reporting",
      "total_requirements": 12,
      "requirements": {
        "REQ-026": {
          "requirement": "The system shall validate that uploaded files are in the correct CSV format before processing.",
          "classification": "project-specific",
          "classification_rationale": "Standard file format validation",
          "priority": "P0",
          "acceptance_criteria": [
            "CSV format validation performed",
            "Non-CSV files rejected"
          ]
        },
        "REQ-027": {
          "requirement": "The system shall validate that all required fields and columns are present in the uploaded file.",
          "classification": "project-specific",
          "classification_rationale": "Standard structural validation",
          "priority": "P0",
          "acceptance_criteria": [
            "Required columns checked",
            "Missing columns reported as errors"
          ]
        },
        "REQ-028": {
          "requirement": "The system shall validate the file structure matches the expected template format.",
          "classification": "project-specific",
          "classification_rationale": "Standard template matching",
          "priority": "P0",
          "acceptance_criteria": [
            "Template structure validated",
            "Structure mismatches reported"
          ]
        },
        "REQ-029": {
          "requirement": "The system shall validate uploaded data for correctness, including proper email formats, valid country codes, currency codes, purpose codes, and payment methods.",
          "classification": "project-specific",
          "classification_rationale": "Standard data validation patterns",
          "priority": "P0",
          "acceptance_criteria": [
            "Email format validation",
            "Country and currency code validation",
            "Purpose code and payment method validation"
          ]
        },
        "REQ-030": {
          "requirement": "The system shall validate that recipient IDs exist in the system before allowing file processing.",
          "classification": "environment-specific",
          "classification_rationale": "Integration with Volopa's recipient database",
          "priority": "P0",
          "acceptance_criteria": [
            "Recipient ID lookup performed",
            "Non-existent IDs rejected"
          ]
        },
        "REQ-031": {
          "requirement": "The system shall validate that payment amounts are positive numeric values in the correct format.",
          "classification": "project-specific",
          "classification_rationale": "Standard numeric validation",
          "priority": "P0",
          "acceptance_criteria": [
            "Amount is numeric",
            "Amount is positive",
            "Decimal precision validated"
          ]
        },
        "REQ-032": {
          "requirement": "The system shall validate that settlement methods match the available options for each recipient.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's compliance with recipient-specific payment rails",
          "priority": "P0",
          "acceptance_criteria": [
            "Settlement method validated against recipient configuration",
            "Mismatches reported as errors"
          ]
        },
        "REQ-033": {
          "requirement": "The system shall validate that all mandatory fields contain values based on currency and recipient type requirements.",
          "classification": "project-specific",
          "classification_rationale": "Standard required field validation",
          "priority": "P0",
          "acceptance_criteria": [
            "Required field validation enforced",
            "Empty required fields reported"
          ]
        },
        "REQ-034": {
          "requirement": "The system shall identify and report validation errors with clear information including row number, column name, provided value, and specific error description.",
          "classification": "project-specific",
          "classification_rationale": "Standard error reporting pattern",
          "priority": "P0",
          "acceptance_criteria": [
            "Error reports include row number",
            "Error reports include column name and value",
            "Error description is clear and actionable"
          ]
        },
        "REQ-035": {
          "requirement": "The system shall allow users to download or view a detailed list of validation errors.",
          "classification": "project-specific",
          "classification_rationale": "Standard error export capability",
          "priority": "P1",
          "acceptance_criteria": [
            "Error list is viewable",
            "Error list is downloadable"
          ]
        },
        "REQ-036": {
          "requirement": "The system shall allow users to correct errors and re-upload the payment file.",
          "classification": "project-specific",
          "classification_rationale": "Standard correction workflow",
          "priority": "P0",
          "acceptance_criteria": [
            "Re-upload is supported",
            "Previous errors are cleared on re-upload"
          ]
        },
        "REQ-037": {
          "requirement": "The system shall allow users to proceed with processing valid payments even if some rows contain errors.",
          "classification": "project-specific",
          "classification_rationale": "Standard partial processing pattern",
          "priority": "P1",
          "acceptance_criteria": [
            "Partial success processing supported",
            "Valid rows processed, invalid rows skipped"
          ]
        }
      }
    },

    "Section_5_File_Summary_Review": {
      "section_name": "File Summary and Review",
      "description": "Requirements for displaying file summaries and review before processing",
      "total_requirements": 4,
      "requirements": {
        "REQ-038": {
          "requirement": "The system shall provide a summary view of each uploaded file, including total number of payments, valid payments, errored payments, and currency breakdown.",
          "classification": "project-specific",
          "classification_rationale": "Standard summary dashboard pattern",
          "priority": "P0",
          "acceptance_criteria": [
            "Summary shows total, valid, and errored counts",
            "Currency breakdown displayed"
          ]
        },
        "REQ-039": {
          "requirement": "The system shall display the file name and upload timestamp in the file summary.",
          "classification": "project-specific",
          "classification_rationale": "Standard file metadata display",
          "priority": "P1",
          "acceptance_criteria": [
            "File name shown",
            "Upload timestamp shown"
          ]
        },
        "REQ-040": {
          "requirement": "The system shall display the funding currency associated with each payment file.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's multi-currency account structure",
          "priority": "P0",
          "acceptance_criteria": [
            "Funding currency displayed in summary"
          ]
        },
        "REQ-041": {
          "requirement": "The system shall allow users to review uploaded file summaries before proceeding or cancelling.",
          "classification": "project-specific",
          "classification_rationale": "Standard confirmation workflow",
          "priority": "P0",
          "acceptance_criteria": [
            "Summary review page available",
            "Proceed and cancel actions available"
          ]
        }
      }
    },

    "Section_6_Approval_Workflow": {
      "section_name": "Approval Workflow",
      "description": "Requirements for approval determination, notification, and process management",
      "total_requirements": 10,
      "requirements": {
        "REQ-042": {
          "requirement": "The system shall enforce client-specific approval requirements based on currency and transaction rules.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's configurable approval policy",
          "priority": "P0",
          "acceptance_criteria": [
            "Approval rules configurable per client",
            "Currency-based rules enforced"
          ]
        },
        "REQ-043": {
          "requirement": "The system shall automatically determine whether uploaded payments require approval based on predefined business rules.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's risk management framework",
          "priority": "P0",
          "acceptance_criteria": [
            "Approval determination automated",
            "Business rules applied consistently"
          ]
        },
        "REQ-044": {
          "requirement": "The system shall send bell icon notifications to all authorized approvers when a payment file requires approval.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's notification mechanism",
          "priority": "P0",
          "acceptance_criteria": [
            "Bell icon notifications sent",
            "All approvers notified"
          ]
        },
        "REQ-045": {
          "requirement": "The system shall ensure that notifications are sent immediately upon successful file validation when approval is required.",
          "classification": "project-specific",
          "classification_rationale": "Standard notification timing",
          "priority": "P0",
          "acceptance_criteria": [
            "Notifications sent immediately after validation",
            "No delays in notification delivery"
          ]
        },
        "REQ-046": {
          "requirement": "The system shall ensure that only one approver can act on a payment file at a time.",
          "classification": "project-specific",
          "classification_rationale": "Standard concurrency control",
          "priority": "P0",
          "acceptance_criteria": [
            "Concurrency control implemented",
            "Locking mechanism prevents duplicate approvals"
          ]
        },
        "REQ-047": {
          "requirement": "The system shall inform other approvers when a payment file has already been picked up for approval.",
          "classification": "project-specific",
          "classification_rationale": "Standard concurrent access messaging",
          "priority": "P1",
          "acceptance_criteria": [
            "Status message shown to subsequent approvers",
            "Clear indication file is already in progress"
          ]
        },
        "REQ-048": {
          "requirement": "The system shall ensure that only authorized users can approve payment files.",
          "classification": "project-specific",
          "classification_rationale": "Standard authorization control",
          "priority": "P0",
          "acceptance_criteria": [
            "Authorization check performed",
            "Unauthorized users blocked from approving"
          ]
        },
        "REQ-049": {
          "requirement": "The system shall prevent the same user who uploaded a file from also approving it.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's separation of duties policy",
          "priority": "P0",
          "acceptance_criteria": [
            "Uploader identity tracked",
            "Self-approval blocked"
          ]
        },
        "REQ-050": {
          "requirement": "The system shall redirect the first approver to click the notification to a Payment Confirmation Page to complete the payment creation.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's specific approval workflow screens",
          "priority": "P0",
          "acceptance_criteria": [
            "First approver redirected to Payment Confirmation Page",
            "Payment creation initiated"
          ]
        },
        "REQ-051": {
          "requirement": "The system shall redirect subsequent approvers who click after another approver has picked up the file to the Draft Payments Page.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's concurrent approval handling",
          "priority": "P1",
          "acceptance_criteria": [
            "Subsequent approvers redirected to Draft Payments Page",
            "Informational message displayed"
          ]
        }
      }
    },

    "Section_7_Status_Tracking_File_Management": {
      "section_name": "Status Tracking and File Management",
      "description": "Requirements for file status visibility, history, and lifecycle management",
      "total_requirements": 11,
      "requirements": {
        "REQ-052": {
          "requirement": "The system shall track payment files through the following states: Draft, Validating, Validation Failed, Awaiting Approval, Approved, Processing, Completed, and Failed.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's defined state machine",
          "priority": "P0",
          "acceptance_criteria": [
            "8 states tracked",
            "State transitions enforced"
          ]
        },
        "REQ-053": {
          "requirement": "The system shall allow users to view the current processing status of uploaded payment files.",
          "classification": "project-specific",
          "classification_rationale": "Standard status visibility",
          "priority": "P0",
          "acceptance_criteria": [
            "Current status displayed",
            "Status accessible from file list"
          ]
        },
        "REQ-054": {
          "requirement": "The system shall display clear status indicators (e.g., icons, colors) to distinguish between different file states.",
          "classification": "project-specific",
          "classification_rationale": "Standard status visualization",
          "priority": "P1",
          "acceptance_criteria": [
            "Icons or colors used for status",
            "Visual distinction between states"
          ]
        },
        "REQ-055": {
          "requirement": "The system shall allow users to track progress while uploaded files are being validated or processed.",
          "classification": "project-specific",
          "classification_rationale": "Standard progress tracking",
          "priority": "P1",
          "acceptance_criteria": [
            "Progress tracking available",
            "Real-time or near-real-time updates"
          ]
        },
        "REQ-056": {
          "requirement": "The system shall display processing progress for large payment files, including percentage complete or estimated time remaining.",
          "classification": "project-specific",
          "classification_rationale": "Standard progress indicator pattern",
          "priority": "P2",
          "acceptance_criteria": [
            "Percentage or time estimate shown",
            "Progress updates regularly"
          ]
        },
        "REQ-057": {
          "requirement": "The system shall allow users to view a list of all previously uploaded payment files associated with their account.",
          "classification": "project-specific",
          "classification_rationale": "Standard file history view",
          "priority": "P0",
          "acceptance_criteria": [
            "File history list available",
            "List scoped to user's account"
          ]
        },
        "REQ-058": {
          "requirement": "The system shall maintain a complete history of all payment files processed by each client.",
          "classification": "project-specific",
          "classification_rationale": "Standard record retention",
          "priority": "P0",
          "acceptance_criteria": [
            "Complete file history maintained",
            "No data loss"
          ]
        },
        "REQ-059": {
          "requirement": "The system shall allow users to filter file lists by status (e.g., draft, pending approval, completed).",
          "classification": "project-specific",
          "classification_rationale": "Standard list filtering",
          "priority": "P1",
          "acceptance_criteria": [
            "Status filter available",
            "Multiple status filters supported"
          ]
        },
        "REQ-060": {
          "requirement": "The system shall allow users to delete payment files that are still in draft or failed validation states.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's file lifecycle policy",
          "priority": "P1",
          "acceptance_criteria": [
            "Delete available for draft/failed files",
            "Deletion confirmed with user"
          ]
        },
        "REQ-061": {
          "requirement": "The system shall prevent users from deleting payment files that have already been approved or completed.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's audit and immutability rules",
          "priority": "P0",
          "acceptance_criteria": [
            "Delete blocked for approved/completed files",
            "Clear error message shown"
          ]
        },
        "REQ-062": {
          "requirement": "The system shall allow users to cancel file processing while in the validation stage.",
          "classification": "project-specific",
          "classification_rationale": "Standard cancellation capability",
          "priority": "P2",
          "acceptance_criteria": [
            "Cancel available during validation",
            "Processing stops immediately"
          ]
        }
      }
    },

    "Section_8_User_Permissions_Security": {
      "section_name": "User Permissions and Security",
      "description": "Requirements for role-based access control and separation of duties",
      "total_requirements": 2,
      "requirements": {
        "REQ-063": {
          "requirement": "The system shall restrict file upload, approval, and deletion capabilities to authorized users based on their assigned roles.",
          "classification": "project-specific",
          "classification_rationale": "Standard RBAC pattern",
          "priority": "P0",
          "acceptance_criteria": [
            "Role-based permissions enforced",
            "Unauthorized actions blocked"
          ]
        },
        "REQ-064": {
          "requirement": "The system shall enforce separation of duties by preventing uploaders from approving their own payment files.",
          "classification": "project-specific",
          "classification_rationale": "Standard SoD control",
          "priority": "P0",
          "acceptance_criteria": [
            "Self-approval prevented",
            "SoD enforced system-wide"
          ]
        }
      }
    },

    "Section_9_Notifications_User_Communication": {
      "section_name": "Notifications and User Communication",
      "description": "Requirements for notifying users of validation results and payment processing",
      "total_requirements": 3,
      "requirements": {
        "REQ-065": {
          "requirement": "The system shall notify the file uploader when file validation is complete.",
          "classification": "project-specific",
          "classification_rationale": "Standard process completion notification",
          "priority": "P1",
          "acceptance_criteria": [
            "Notification sent to uploader",
            "Notification includes validation result"
          ]
        },
        "REQ-066": {
          "requirement": "The system shall notify the file uploader of validation failures with actionable guidance.",
          "classification": "project-specific",
          "classification_rationale": "Standard error notification",
          "priority": "P0",
          "acceptance_criteria": [
            "Failure notification sent",
            "Actionable guidance included"
          ]
        },
        "REQ-067": {
          "requirement": "The system shall send email notifications to recipients and CC addresses once payments are successfully processed.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's customer communication requirement",
          "priority": "P1",
          "acceptance_criteria": [
            "Email sent to recipient",
            "CC addresses included",
            "Email sent after successful processing"
          ]
        }
      }
    },

    "Section_10_Audit_Traceability": {
      "section_name": "Audit and Traceability",
      "description": "Requirements for activity logging and audit trail maintenance",
      "total_requirements": 3,
      "requirements": {
        "REQ-068": {
          "requirement": "The system shall record the timestamp and user identity for all file uploads, approvals, and status changes.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's audit requirements",
          "priority": "P0",
          "acceptance_criteria": [
            "Timestamp recorded for all actions",
            "User identity captured"
          ]
        },
        "REQ-069": {
          "requirement": "The system shall maintain a complete audit trail of all actions taken on each payment file.",
          "classification": "environment-specific",
          "classification_rationale": "Volopa's regulatory compliance requirement",
          "priority": "P0",
          "acceptance_criteria": [
            "Complete audit trail maintained",
            "No gaps in audit log"
          ]
        },
        "REQ-070": {
          "requirement": "The system shall allow authorized users to view the audit history for any payment file.",
          "classification": "project-specific",
          "classification_rationale": "Standard audit log access",
          "priority": "P1",
          "acceptance_criteria": [
            "Audit history viewable",
            "Access restricted to authorized users"
          ]
        }
      }
    },

    "Section_11_User_Experience_Guidance": {
      "section_name": "User Experience and Guidance",
      "description": "Requirements for help documentation, examples, and user feedback",
      "total_requirements": 6,
      "requirements": {
        "REQ-071": {
          "requirement": "The system shall provide accessible user guides explaining the complete mass payment workflow.",
          "classification": "project-specific",
          "classification_rationale": "Standard documentation requirement",
          "priority": "P1",
          "acceptance_criteria": [
            "User guide available",
            "Complete workflow documented"
          ]
        },
        "REQ-072": {
          "requirement": "The system shall provide examples of correctly completed payment file templates.",
          "classification": "project-specific",
          "classification_rationale": "Standard help documentation",
          "priority": "P1",
          "acceptance_criteria": [
            "Example templates provided",
            "Examples are accurate"
          ]
        },
        "REQ-073": {
          "requirement": "The system shall provide error resolution guidance for common validation failures.",
          "classification": "project-specific",
          "classification_rationale": "Standard troubleshooting documentation",
          "priority": "P1",
          "acceptance_criteria": [
            "Error resolution guide available",
            "Common errors covered"
          ]
        },
        "REQ-074": {
          "requirement": "The system shall provide immediate visual feedback for all user actions (upload, validate, approve, delete).",
          "classification": "project-specific",
          "classification_rationale": "Standard UI feedback pattern",
          "priority": "P0",
          "acceptance_criteria": [
            "Feedback shown for all actions",
            "Feedback is immediate"
          ]
        },
        "REQ-075": {
          "requirement": "The system shall display success confirmations when files are successfully uploaded, validated, or approved.",
          "classification": "project-specific",
          "classification_rationale": "Standard success messaging",
          "priority": "P1",
          "acceptance_criteria": [
            "Success messages displayed",
            "Messages are clear and positive"
          ]
        },
        "REQ-076": {
          "requirement": "The system shall display clear error messages when operations fail, with guidance on next steps.",
          "classification": "project-specific",
          "classification_rationale": "Standard error messaging UX",
          "priority": "P0",
          "acceptance_criteria": [
            "Error messages are clear",
            "Next steps guidance provided"
          ]
        }
      }
    }
  },

  "requirements_classification_summary": {
    "total_requirements": 76,
    "environment_specific": {
      "count": 29,
      "percentage": 38,
      "description": "Requirements unique to Volopa's business context, regulatory environment, currency handling rules, or specific business processes"
    },
    "project_specific": {
      "count": 47,
      "percentage": 62,
      "description": "General functionality patterns common to bulk payment processing systems, transferable to other similar systems"
    },
    "architectural_implications": "Environment-specific requirements should be externalized as business rules (currency validations, approval policies, data model specifics) from core processing logic. This enables easier configuration changes and potential reuse.",
    "testing_strategy": "Environment-specific requirements require business rule testing and market-specific test scenarios. Project-specific requirements can leverage standard test patterns and shared test frameworks."
  },

  "technical_constraints": {
    "dos_donts_source": "industry/dos_and_donts.pdf",
    "mental_model": "Client → route (versioned, throttled, auth) → controller → FormRequest (validation + policy) → domain logic (services/models/transactions) → API Resource (shape output) → JSON with correct status codes",
    "laravel_file_structure": {
      "routes": "routes/api.php",
      "controllers": "app/Http/Controllers/Api/V1/",
      "requests": "app/Http/Requests/",
      "services": "app/Services/",
      "models": "app/Models/",
      "migrations": "database/migrations/",
      "resources": "app/Http/Resources/",
      "policies": "app/Policies/",
      "jobs": "app/Jobs/",
      "notifications": "app/Notifications/"
    },
    "code_organization_by_classification": {
      "environment_specific": [
        "app/Config/ - Environment-Specific configs",
        "app/Services/Volopa/ - Volopa-specific business rules",
        "app/Validators/Rules/ - Environment-Specific validation rules",
        "config/mass_payments.php - Currency rules, approval policies"
      ],
      "project_specific": [
        "app/Services/Core/ - Reusable core services",
        "app/Http/Controllers/Api/V1/ - Generic API controllers",
        "app/Models/ - Generic models (can be extended)"
      ]
    },
    "volopa_specific": {
      "authentication": ["OAuth2", "WSSE"],
      "tenant_isolation": "client_id on all tables",
      "currency_rules": "Currency-specific approval workflows (REQ-042, REQ-043)",
      "settlement_methods": ["Priority", "Regular", "Priority and Regular"],
      "purpose_codes": "Dependent on Bank Country and Account Currency",
      "regulatory_requirements": {
        "INR": "Invoice Number and Invoice Date required",
        "TRY": "Incorporation Number required for business recipients"
      },
      "multi_tenant": true
    }
  },

  "summary_statistics": {
    "total_sections": 11,
    "total_requirements": 76,
    "environment_specific_requirements": 29,
    "project_specific_requirements": 47,
    "priority_breakdown": {
      "P0": "Core functionality (approx. 40 requirements)",
      "P1": "Important features (approx. 28 requirements)",
      "P2": "Nice to have (approx. 8 requirements)"
    },
    "key_user_journeys": 3,
    "key_journeys": ["Download Template", "Upload & Validate CSV", "Review & Approve"],
    "validation_types": 5,
    "validation_categories": ["Format", "Structure", "Data", "Conditional", "Business Rules"],
    "file_statuses": 8,
    "status_list": ["Draft", "Validating", "Validation Failed", "Awaiting Approval", "Approved", "Processing", "Completed", "Failed"],
    "maximum_capacity": 10000,
    "capacity_description": "10,000 payment rows per CSV file"
  },

  "expected_outputs": {
    "LaravelProductManager": {
      "file": "docs/prd/volopa_mass_payments.md",
      "sections": [
        "Business Requirements (76 requirements across 11 sections)",
        "User Stories (mapped to requirements)",
        "Acceptance Criteria",
        "API Endpoint Specifications",
        "Security and Compliance Requirements",
        "Detailed Functional Requirements (ALL 76 requirements with priorities and classification)",
        "Requirements Classification Summary"
      ]
    },
    "LaravelArchitect": {
      "file": "docs/system_design/volopa_mass_payments.md",
      "sections": [
        "Data Models (MassPaymentFile, PaymentInstruction, etc.)",
        "Database Schema with Relationships",
        "API Endpoint Design (routes, methods, responses)",
        "Service Layer Architecture",
        "Status State Machine (8 states)",
        "Validation Architecture",
        "Async Job Architecture",
        "Integration with Existing Volopa Models",
        "Security Design (client isolation, RBAC)",
        "Environment-Specific vs Project-Specific Design Patterns"
      ]
    },
    "LaravelProjectManager": {
      "file": "docs/task/volopa_mass_payments.json",
      "content": "Task breakdown mapping 76 requirements to implementation tasks with dependencies"
    },
    "LaravelEngineer": {
      "directory": "app/",
      "files": {
        "models": 8,
        "controllers": 5,
        "services": 8,
        "form_requests": 4,
        "policies": 2,
        "api_resources": 8,
        "jobs": 2,
        "migrations": 5,
        "validation_rules": 8,
        "routes": 1,
        "config": 1
      },
      "total_files": 52,
      "organization": "Environment-specific code in app/Services/Volopa/ and config/, project-specific code in app/Services/Core/"
    },
    "LaravelQaEngineer": {
      "directory": "tests/",
      "test_coverage": "ALL 76 requirements",
      "test_naming": "test_{requirement_id}_{description}",
      "environment_specific_tests": "Business rules and configuration (29 requirements)",
      "project_specific_tests": "Generic behavior and edge cases (47 requirements)"
    }
  }
}